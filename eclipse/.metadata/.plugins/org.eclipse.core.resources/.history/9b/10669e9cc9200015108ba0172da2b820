package io.github.phantamanta44.war3.handler;

import io.github.phantamanta44.war3.SoundType;
import io.github.phantamanta44.war3.War3;
import io.github.phantamanta44.war3.render.PumpedItemRenderer;
import net.minecraft.client.Minecraft;
import net.minecraft.init.Items;
import net.minecraftforge.client.event.sound.PlaySoundEvent;
import net.minecraftforge.fml.common.eventhandler.EventPriority;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class SoundInterceptor {
	
	@SubscribeEvent(priority=EventPriority.NORMAL)
	public void onSoundPlay(PlaySoundEvent event) {
		Minecraft mc = Minecraft.getMinecraft();
		final String path = event.sound.getSoundLocation().getResourcePath();
		if (path.contains("ambient.cave") && event.isCancelable()) {
			event.setCanceled(true);
			String team = War3.cachedTeam;
			if (team.equals("red")) {
				mc.theWorld.playSoundAtEntity(mc.thePlayer, SoundType.RESPAWNRED.getLoc(), 1.0F, 1.0F);
			}
			else if (team.equals("blue")) {
				mc.theWorld.playSoundAtEntity(mc.thePlayer, SoundType.RESPAWNBLUE.getLoc(), 1.0F, 1.0F);
			}
		}
		if (event.sound.getPitch() == 2.0F) {
			if (isNearPlayer(event.sound, mc, 0.25)) {
				KickbackHandler.tryKickback(path, mc);
				if (path.contains("tile.piston")) {
					if (path.equals("tile.piston.out"))
						PumpedItemRenderer.setPumping(true);
					else
						PumpedItemRenderer.setPumping(false);
				}
			}
		}
	}
	
	public static boolean isNearPlayer(ISound snd, Minecraft mc, float accuracy) {
		
	}
	
}
