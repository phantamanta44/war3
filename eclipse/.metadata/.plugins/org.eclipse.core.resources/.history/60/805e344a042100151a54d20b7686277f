package io.github.phantamanta44.war3.handler;

import io.github.phantamanta44.war3.render.fx.FXSparkle;
import io.github.phantamanta44.war3.render.fx.ParticleRenderDispatcher;

import java.util.Random;

import net.minecraft.client.Minecraft;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.util.Vec3;
import net.minecraftforge.client.event.RenderLivingEvent;
import net.minecraftforge.client.event.RenderWorldLastEvent;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class WorldRenderHandler {
	
	private Minecraft mc;
	
	public WorldRenderHandler(Minecraft minecraft) {
		mc = minecraft;
	}
	
	@SubscribeEvent
	public void onRenderEntity(RenderLivingEvent.Post event) {
		if (!(event.entity instanceof EntityPlayer))
			return;
		//if (War3.awesomePeople.contains(event.entityPlayer.getUniqueID().toString())) {
			Vec3 pos = event.entity.getPositionVector();
			Random rand = mc.theWorld.rand;
			int x = rand.nextInt(16);
			if (x == 0) {
				FXSparkle spark = new FXSparkle(mc.theWorld, pos.xCoord + rand.nextFloat() - 0.5, pos.yCoord + rand.nextFloat() * 2, pos.zCoord + rand.nextFloat() - 0.5,
						2.0F, 1.0F, 1.0F, 1.0F, 4);
				mc.effectRenderer.addEffect(spark);
			}
		//}
	}
	
	@SubscribeEvent
	public void onRenderWorldLast(RenderWorldLastEvent event) {
		ParticleRenderDispatcher.dispatch();
	}
	
}
